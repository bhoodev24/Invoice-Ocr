"use strict";(self.webpackChunkberry_free_material_react_cra=self.webpackChunkberry_free_material_react_cra||[]).push([[71],{5071:function(e,t,o){o.r(t),o.d(t,{default:function(){return y}});var n=o(7313),r=o(8197),l=o(4195),a=o(6968),s=o(6370),i=o(9624),c=o(7648),u=o(6015),d=o(765),p=o(5566),g=o.n(p),f=o(6573),h=o(6287),m=o(2549),x=o(6417);var y=()=>{const[e,t]=(0,n.useState)(""),[o,p]=(0,n.useState)(""),y=(0,n.useRef)(null),[$,w]=(0,n.useState)(""),[j,S]=(0,n.useState)([1]),[v,Z]=(0,n.useState)(5),[b,C]=(0,n.useState)(1),[F,P]=(0,n.useState)(""),[k,I]=(0,n.useState)(12);(0,n.useEffect)((()=>{O()}),[]);const O=async()=>{let e;e=(await f.Z.get(h.Z.API_URL+"api/users/getclients")).data,console.log("dtat",e);let t=new Date;for(let o=0;o<e.length;o++){e[o].key=(0,m.Z)(),e[o].no=o+1;let n=new Date(t.getFullYear(),t.getMonth()-12),r=n.getFullYear(),l=(n.getMonth()+1).toString().padStart(2,"0"),a=`${r}-${l}`;r=t.getFullYear(),l=(t.getMonth()+1).toString().padStart(2,"0");const s=`${r}-${l}`;e[o].period=a+" - "+s;const i=await f.Z.post(h.Z.API_URL+"api/users/getusers",{agency_id:e[o]._id});let c=0,u=0;e[o].quotapermonth=i.data;const d=await f.Z.post(h.Z.API_URL+"api/users/getbills",{agency_id:e[o]._id});console.log("response",d.data),e[o].consumptionpermonth=d.data;for(let t=0;t<12;t++)c+=e[o].consumptionpermonth[t],u+=e[o].quotapermonth[t];e[o].quota=e[o].fee*u+"\u20ac",e[o].consumptionfee=parseFloat(e[o].consumption),e[o].consumption=(parseFloat(e[o].consumption)*c).toFixed(1)+"\u20ac",console.log("one",e[o].consumption)}console.log("client",e[0].id),console.log("whole",e),w(e),P(e)},_=(e,t,o)=>{console.log("selectedKeys",e,o);let n=0,r=[];e[0]?(F.map((t=>{t[o]==e[0]&&r.push(t)})),r.map((e=>{e.no=n+1,n++})),console.log("handle",r),w(r)):(r=F,r.map((e=>{e.no=n+1,n++})),w(r))},U={pageSize:v,current:b,total:$.length,showSizeChanger:!1,pageSizeOptions:["5","10","15"],showTotal:e=>`Total ${e} elementos`,onShowSizeChange:(e,t)=>z(t)},D=[{title:"No",dataIndex:"no",align:"center"},{title:"Agencia",dataIndex:"id",align:"center",width:"30%",...(R="id",{filterDropdown:e=>{let{setSelectedKeys:o,selectedKeys:n,confirm:i,clearFilters:c,close:u}=e;return(0,x.jsxs)(r.Z,{style:{padding:8},onKeyDown:e=>e.stopPropagation(),children:[(0,x.jsx)(l.Z,{ref:y,placeholder:`Buscar ${R}`,value:n[0],onChange:e=>o(e.target.value?[e.target.value]:[]),onPressEnter:()=>_(n,0,R),style:{marginBottom:8,display:"block"}}),(0,x.jsxs)(a.Z,{children:[(0,x.jsx)(s.ZP,{type:"primary",onClick:()=>_(n,0,R),icon:(0,x.jsx)(d.Z,{}),size:"small",style:{width:90},children:"Buscar"}),(0,x.jsx)(s.ZP,{onClick:()=>c&&(e=>{e(),t("")})(c),size:"small",style:{width:90},children:"reiniciar"}),(0,x.jsx)(s.ZP,{type:"link",size:"small",onClick:()=>{i({closeDropdown:!1}),t(n[0]),p(R)},children:"Filtrar"}),(0,x.jsx)(s.ZP,{type:"link",size:"small",onClick:()=>{u()},children:"cerca"})]})]})},filterIcon:e=>(0,x.jsx)(d.Z,{style:{color:e?"#1677ff":void 0}}),onFilter:(e,t)=>t[R].toString().toLowerCase().includes(e.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout((()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.select()}),100)},render:t=>o===R?(0,x.jsx)(g(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[e],autoEscape:!0,textToHighlight:t?t.toString():""}):t})},{title:"Per\xedodo",dataIndex:"period",align:"center"},{title:"consumo(\u20ac)",dataIndex:"consumption",align:"center"},{title:"cuota(\u20ac)",dataIndex:"quota",align:"center"}];var R;const z=e=>{Z(e),C(1)};return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(r.Z,{children:(0,x.jsxs)(i.Z,{span:24,children:[(0,x.jsx)(r.Z,{justify:"center",style:{marginBottom:20},children:(0,x.jsxs)(c.ZP.Group,{onChange:e=>{let t=F,o=new Date;console.log("handle",F);for(let n=0;n<F.length;n++){let r=0,l=0;for(let t=0;t<e.target.value;t++)r+=parseFloat((F[n].consumptionpermonth[t]*F[n].consumptionfee).toFixed(2)),l+=parseFloat((F[n].quotapermonth[t]*F[n].fee).toFixed(2)),console.log("data",parseFloat((F[n].consumptionpermonth[t]*F[n].consumptionfee).toFixed(2)));let a=new Date(o.getFullYear(),o.getMonth()-e.target.value),s=a.getFullYear(),i=(a.getMonth()+1).toString().padStart(2,"0"),c=`${s}-${i}`;s=o.getFullYear(),i=(o.getMonth()+1).toString().padStart(2,"0");let u=`${s}-${i}`;t[n].period=c+" - "+u,t[n].consumption=r.toFixed(1),t[n].quota=l.toFixed(1)}I(e.target.value)},value:k,children:[(0,x.jsx)(c.ZP,{value:1,children:"1 Ultimo Mes"}),(0,x.jsx)(c.ZP,{value:3,children:"3 mes"}),(0,x.jsx)(c.ZP,{value:6,children:"6 mes"}),(0,x.jsx)(c.ZP,{value:12,children:"1 a\xf1o "})]})}),(0,x.jsx)(u.Z,{columns:D,dataSource:$,size:"middle",pagination:U,rowClassName:e=>j.includes(e.no)?"selected-row":"",onChange:e=>{C(e.current)},onRow:e=>({onClick:()=>(e=>{console.log("handleclick",e.key),S([e.no]),setSelect(parseInt(e.no)-1)})(e)})})]})})})}},9624:function(e,t,o){var n=o(6297);t.Z=n.Z},6297:function(e,t,o){var n=o(6123),r=o.n(n),l=o(7313),a=o(4714),s=o(6223),i=o(2358),c=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o};const u=["xs","sm","md","lg","xl","xxl"],d=l.forwardRef(((e,t)=>{const{getPrefixCls:o,direction:n}=l.useContext(a.E_),{gutter:d,wrap:p,supportFlexGap:g}=l.useContext(s.Z),{prefixCls:f,span:h,order:m,offset:x,push:y,pull:$,className:w,children:j,flex:S,style:v}=e,Z=c(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),b=o("col",f),[C,F]=(0,i.c)(b);let P={};u.forEach((t=>{let o={};const r=e[t];"number"===typeof r?o.span=r:"object"===typeof r&&(o=r||{}),delete Z[t],P=Object.assign(Object.assign({},P),{[`${b}-${t}-${o.span}`]:void 0!==o.span,[`${b}-${t}-order-${o.order}`]:o.order||0===o.order,[`${b}-${t}-offset-${o.offset}`]:o.offset||0===o.offset,[`${b}-${t}-push-${o.push}`]:o.push||0===o.push,[`${b}-${t}-pull-${o.pull}`]:o.pull||0===o.pull,[`${b}-${t}-flex-${o.flex}`]:o.flex||"auto"===o.flex,[`${b}-rtl`]:"rtl"===n})}));const k=r()(b,{[`${b}-${h}`]:void 0!==h,[`${b}-order-${m}`]:m,[`${b}-offset-${x}`]:x,[`${b}-push-${y}`]:y,[`${b}-pull-${$}`]:$},w,P,F),I={};if(d&&d[0]>0){const e=d[0]/2;I.paddingLeft=e,I.paddingRight=e}if(d&&d[1]>0&&!g){const e=d[1]/2;I.paddingTop=e,I.paddingBottom=e}return S&&(I.flex=function(e){return"number"===typeof e?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}(S),!1!==p||I.minWidth||(I.minWidth=0)),C(l.createElement("div",Object.assign({},Z,{style:Object.assign(Object.assign({},I),v),className:k,ref:t}),j))}));t.Z=d},2549:function(e,t,o){o.d(t,{Z:function(){return c}});var n={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let r;const l=new Uint8Array(16);function a(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(l)}const s=[];for(let u=0;u<256;++u)s.push((u+256).toString(16).slice(1));function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}var c=function(e,t,o){if(n.randomUUID&&!t&&!e)return n.randomUUID();const r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){o=o||0;for(let e=0;e<16;++e)t[o+e]=r[e];return t}return i(r)}}}]);